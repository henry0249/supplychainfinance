(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"g8+a":function(e,a,t){e.exports={container:"container___25AJR",header:"header___2lKmV",col:"col___13lj4",name:"name___1SScC",body:"body___3XVg1",td:"td___MWV5A",newModal:"newModal___2u9Dp",configModal:"configModal___VPCUa",userModal:"userModal___2ZOVX"}},"ib+G":function(e,a,t){e.exports={body:"body___2GbP2",td:"td___19Q7Y"}},oVtg:function(e,a,t){"use strict";t.r(a);t("P2fV");var n,o,r,s,l,c,i,m=t("NJEC"),u=(t("+L6B"),t("2/Rp")),d=(t("5NDa"),t("5rEg")),g=(t("Pwec"),t("CtXQ")),p=(t("sPJy"),t("bE4q")),h=(t("miYZ"),t("tsqr")),f=t("2Taf"),E=t.n(f),y=t("vZ4D"),v=t.n(y),k=t("l4Ni"),b=t.n(k),C=t("ujKo"),N=t.n(C),w=t("MhPg"),S=t.n(w),P=(t("OaEy"),t("2fM7")),_=(t("y8nQ"),t("Vl3Y")),I=t("q1tI"),M=t.n(I),R=t("DBZ+"),V=t.n(R),x=t("3a4m"),O=t.n(x),z=t("wY1l"),B=t.n(z),T=t("bKel"),q=t.n(T),D=t("x31Y"),j=(t("IzEo"),t("bx4M")),J=(t("14J3"),t("BMrR")),K=(t("g9YV"),t("wCAj")),Y=(t("5Dmo"),t("3S7+")),A=t("ib+G"),L=t.n(A),U=(n=_["a"].create(),q()(o=n((r=function(e){function a(){var e,t;E()(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return t=b()(this,(e=N()(a)).call.apply(e,[this].concat(o))),t.state={logs:[],logsPage:{currentPage:1,pageSize:10,totalPage:0,totalRecords:0}},t.getBaseLogs=function(e){Object(D["c"])(e).then(function(e){0===e.code?t.setState({logs:e.data,logsPage:e.page||{currentPage:1,pageSize:10,totalPage:0,totalRecords:0}}):t.setState({logs:[],logsPage:{currentPage:1,pageSize:10,totalPage:0,totalRecords:0}},function(){return h["a"].error("\u83b7\u53d6\u64cd\u4f5c\u65e5\u5fd7\u5931\u8d25\uff1a"+e.msg)})})},t}return S()(a,e),v()(a,[{key:"componentDidMount",value:function(){this.getBaseLogs(1)}},{key:"render",value:function(){var e=this,a=this.state,t=a.logs,n=a.logsPage,o=[{title:"\u64cd\u4f5c\u7c7b\u578b",dataIndex:"operateModuleType",key:"operateModuleType",width:"15%"},{title:"\u64cd\u4f5c\u4eba",dataIndex:"operatorName",key:"operatorName",width:"15%"},{title:"\u6743\u9650\u7ec4",dataIndex:"roleName",key:"roleName",width:"20%"},{title:"\u6267\u884c\u7ed3\u679c",dataIndex:"operateMsg",key:"operateMsg",render:function(e,a){return M.a.createElement(Y["a"],{title:e},M.a.createElement("div",{className:L.a.td},e))},width:"30%"},{title:"\u64cd\u4f5c\u65f6\u95f4",dataIndex:"operateTime",key:"operateTime",width:"20%"}];return M.a.createElement("div",{className:L.a.body},M.a.createElement(j["a"],{title:"\u64cd\u4f5c\u65e5\u5fd7",bordered:!1,style:{marginBottom:24,paddingBottom:12}},M.a.createElement(J["a"],null,M.a.createElement(K["a"],{rowKey:"id",dataSource:t,columns:o,pagination:{size:"small",current:n.currentPage,pageSize:n.pageSize,total:n.totalRecords,onChange:function(a){return e.getBaseLogs(a)},showTotal:function(e,a){return"\u5171 ".concat(n.totalRecords," \u6761\u8bb0\u5f55 \u7b2c ").concat(n.currentPage," / ").concat(n.totalPage," \u9875")}}}))))}}]),a}(I["Component"]),o=r))||o)||o),X=(t("2qtc"),t("kLXV")),Z=(t("sRBo"),t("kaz8")),G=(t("jCWc"),t("kPKH")),Q=t("rlhR"),F=t.n(Q),W=t("g8+a"),H=t.n(W),$=_["a"].Item,ee=(P["a"].Option,s=_["a"].create(),q()(l=s((c=function(e){function a(){var e,t;E()(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return t=b()(this,(e=N()(a)).call.apply(e,[this].concat(o))),t.state={newVisible:!1,configVisible:!1,userVisible:!1,roles:[],rolesData:[],rolesPage:{currentPage:1,pageSize:5,totalPage:0,totalRecords:0},rolesModal:{},allOptions:[],options:[],selectedOptions:[],checkedValues:[],allUsers:[],users:[],selectedUsers:[],checkedUsers:[],permissionName:""},t.getRoles=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.state.rolesPage.currentPage,a=t.props.location.query.id;Object(D["d"])({currentPage:e,id:a}).then(function(e){0===e.code?t.setState({rolesData:e.data,rolesPage:e.page}):h["a"].error("\u83b7\u53d6\u4f01\u4e1a\u4e0b\u6240\u6709\u6743\u9650\u7ec4\u5931\u8d25\uff1a"+e.msg)})},t.onCurrentChange=function(e){t.getRoles(e)},t.handleConfig=function(e){var a=t.props.location.query.id;Object(D["a"])({permissionId:a}).then(function(a){0===a.code?t.setState({rolesModal:e,configVisible:!0,allOptions:a.data.allResource||[],options:a.data.allResource||[],selectedOptions:a.data.selectResource||[],checkedValues:a.data.chosenResourceIds||[],permissionName:a.data.permissionName}):h["a"].error("\u83b7\u53d6\u53ef\u9009\u7b56\u7565\u5931\u8d25\uff1a"+a.msg)})},t.searchConfig=function(e){var a=t.state.allOptions,n=[];a.forEach(function(a){a.resourceName.indexOf(e)>-1&&n.push(a)}),t.setState({options:n})},t.checkboxChange=function(e,a){var n=t.state,o=n.options,r=n.selectedOptions,s=n.checkedValues;if(e){for(var l=0;l<o.length;l++)if(a===o[l].resourceId){r.push(o[l]),s.push(a);break}}else{for(var c=0;c<r.length;c++)if(a===r[c].resourceId){r.splice(c,1);break}for(var i=0;i<s.length;i++)if(a===s[i]){s.splice(i,1);break}}t.setState({selectedOptions:r,checkedValues:s})},t.saveConfig=function(){var e=t.props.location.query.id,a=t.state.checkedValues,n={chosenResourceIds:a,permissionId:e},o=F()(t);Object(D["e"])(n).then(function(e){0===e.code?t.setState({configVisible:!1,rolesModal:{},allOptions:[],options:[],selectedOptions:[],checkedValues:[]},function(){h["a"].success("\u4fdd\u5b58\u914d\u7f6e\u6210\u529f"),o.getRoles(1)}):h["a"].error("\u4fdd\u5b58\u914d\u7f6e\u5931\u8d25\uff1a"+e.msg)})},t}return S()(a,e),v()(a,[{key:"componentDidMount",value:function(){this.getRoles(1)}},{key:"render",value:function(){var e=this,a=this.state,t=a.configVisible,n=a.rolesData,o=a.rolesPage,r=(a.rolesModal,a.options),s=a.selectedOptions,l=a.checkedValues,c=a.permissionName,i=[{title:"\u6a21\u5757",dataIndex:"parentName",key:"parentName",width:"30%"},{title:"\u6743\u9650",dataIndex:"resourceName",key:"resourceName",width:"20%"},{title:"\u4fee\u6539\u65f6\u95f4",dataIndex:"modifyTime",key:"modifyTime",width:"20%"}];return M.a.createElement("div",{className:H.a.container},M.a.createElement("div",{className:H.a.body},M.a.createElement(J["a"],null,M.a.createElement(j["a"],{title:"\u6743\u9650\u7ec4",bordered:!1,style:{marginBottom:16}},M.a.createElement(J["a"],{type:"flex",justify:"end",style:{marginBottom:16}},M.a.createElement(u["a"],{onClick:this.handleConfig.bind(this),type:"primary"},"\u914d\u7f6e\u7b56\u7565\u6c60")),M.a.createElement(J["a"],null,M.a.createElement(K["a"],{rowKey:"roleId",dataSource:n,columns:i,pagination:{size:"small",current:o.currentPage,pageSize:o.pageSize,total:o.totalRecords,onChange:this.onCurrentChange.bind(this),showTotal:function(e,a){return"\u5171 ".concat(o.totalRecords," \u6761\u8bb0\u5f55 \u7b2c ").concat(o.currentPage," / ").concat(o.totalPage," \u9875")}}}))))),M.a.createElement(X["a"],{centered:!0,title:"\u914d\u7f6e\u7b56\u7565\u6c60",visible:t,wrapClassName:H.a.configModal,width:900,onOk:this.saveConfig,onCancel:function(){return e.setState({configVisible:!1})}},M.a.createElement(_["a"],{layout:"inline",hideRequiredMark:!0},M.a.createElement(J["a"],{gutter:24,style:{marginBottom:24}},M.a.createElement(G["a"],{span:18},"\u6240\u5c5e\u4f01\u4e1a\u89d2\u8272\uff1a",c)),M.a.createElement(J["a"],{gutter:24,style:{marginBottom:16}},M.a.createElement(G["a"],{span:12},M.a.createElement($,{label:"\u53ef\u9009\u7b56\u7565\uff08\u5171".concat(r.length||0,"\u6761\uff09")},M.a.createElement(d["a"].Search,{allowClear:!1,style:{width:223},placeholder:"\u8bf7\u8f93\u5165\u7b56\u7565\u540d\u79f0",onSearch:function(a){return e.searchConfig(a)}})))),M.a.createElement(J["a"],{gutter:24},M.a.createElement(G["a"],{span:12},M.a.createElement(j["a"],{title:M.a.createElement(J["a"],{style:{padding:"0 8px 0 24px",fontSize:14}},M.a.createElement(G["a"],{span:12},"\u6a21\u5757"),M.a.createElement(G["a"],{span:12},"\u6743\u9650"))},r.map(function(a){return M.a.createElement(Z["a"],{onChange:function(t){return e.checkboxChange(t.target.checked,a.resourceId)},checked:l.includes(a.resourceId),key:a.resourceId},M.a.createElement(J["a"],null,M.a.createElement(G["a"],{span:12},a.parentName),M.a.createElement(G["a"],{span:12},a.resourceName)))}))),M.a.createElement(G["a"],{span:12},M.a.createElement(j["a"],{title:M.a.createElement(J["a"],{style:{fontSize:14}},M.a.createElement(G["a"],{span:10},"\u6a21\u5757"),M.a.createElement(G["a"],{span:10},"\u6743\u9650"),M.a.createElement(G["a"],{span:4},"\u64cd\u4f5c"))},s.map(function(a){return M.a.createElement(J["a"],{style:{marginBottom:12},key:a.resourceId},M.a.createElement(G["a"],{span:10},a.parentName),M.a.createElement(G["a"],{span:10},a.resourceName),M.a.createElement(G["a"],{span:4},M.a.createElement(g["a"],{onClick:e.checkboxChange.bind(e,!1,a.resourceId),type:"close",style:{fontSize:14,cursor:"pointer"}})))})))))))}}]),a}(I["Component"]),l=c))||l)||l);t.d(a,"default",function(){return ae});_["a"].Item,P["a"].Option;var ae=q()(i=function(e){function a(e){var t;return E()(this,a),t=b()(this,N()(a).call(this,e)),t.state={showSave:!1,permissionName:e.location.query.name||"",currentPage:1,pageSize:10,totalPage:0,totalRecords:0},t.id=e.location.query.id||!1,t.name=e.location.query.name||!1,t}return S()(a,e),v()(a,[{key:"componentDidMount",value:function(){}},{key:"roleNameChange",value:function(e){this.setState({permissionName:e})}},{key:"save",value:function(){var e=this,a=this.state.permissionName,t={permissionId:this.id,permissionName:a};Object(D["f"])(t).then(function(t){0===t.code?(h["a"].success(t.msg),e.name=a,O.a.replace("/roleConfig/configure?id=".concat(e.id,"&name=").concat(a)),e.setState({showSave:!1})):h["a"].error(t.msg)})}},{key:"showSave",value:function(e){this.setState({showSave:e})}},{key:"render",value:function(){var e=this,a=this.state,t=a.showSave,n=(a.allPermissons,a.permissionName);a.permissions;return M.a.createElement("div",{className:V.a.container},M.a.createElement("div",{className:V.a.crumb},M.a.createElement(p["a"],{className:V.a.breadcrumb},M.a.createElement(p["a"].Item,null,M.a.createElement(B.a,{to:"/roleConfig"},"\u4f01\u4e1a\u89d2\u8272\u5217\u8868")),M.a.createElement(p["a"].Item,null,"\u4f01\u4e1a\u89d2\u8272\u8be6\u60c5")),M.a.createElement("div",{className:V.a.title},M.a.createElement(g["a"],{style:{fontSize:28},type:"home",theme:"twoTone"}),t?M.a.createElement(I["Fragment"],null,M.a.createElement(d["a"],{className:V.a.input,value:n,onChange:function(a){return e.roleNameChange(a.target.value)}}),M.a.createElement(u["a"],{type:"primary",onClick:this.save.bind(this)},"\u4fdd\u5b58"),M.a.createElement(u["a"],{onClick:this.showSave.bind(this,!1)},"\u53d6\u6d88")):M.a.createElement(I["Fragment"],null,M.a.createElement("span",{className:V.a.name},this.name),M.a.createElement("span",{className:V.a.showSave,onClick:this.showSave.bind(this,!0)},"\u4fee\u6539\u540d\u79f0")),M.a.createElement("div",{className:V.a.btnBox},M.a.createElement(m["a"],{title:"\u9000\u51fa\u540e\u5185\u5bb9\u5c06\u4e0d\u80fd\u4fdd\u5b58",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onConfirm:function(){O.a.push("/roleConfig")}},M.a.createElement(u["a"],{type:"default",size:"large"},"\u8fd4 \u56de"))))),M.a.createElement(ee,{id:this.id}),M.a.createElement(U,null))}}]),a}(I["Component"]))||i}}]);