(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[67],{"I/A2":function(t,e,a){"use strict";var r=a("g09b"),c=a("tAuX");Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=void 0,a("+L6B");var n=r(a("2/Rp"));a("MXD1");var l=r(a("CFYs"));a("sPJy");var o=r(a("bE4q"));a("miYZ");var u=r(a("tsqr")),s=r(a("2Taf")),d=r(a("vZ4D")),i=r(a("l4Ni")),p=r(a("ujKo")),f=r(a("MhPg"));a("2qtc");var m,y,b,C=r(a("kLXV")),g=c(a("q1tI")),h=a("Kvkj"),v=r(a("NtgZ")),I=a("Hg0r"),k=r(a("3a4m")),B=a("dtw8"),E=r(a("wY1l")),N=(C["default"].confirm,m=(0,I.connect)(function(t){var e=t.contract,a=t.global,r=t.orderManage;return{contract:e,global:a,orderManage:r}}),(0,B.withRouter)(y=m((b=function(t){function e(t){var a;return(0,s["default"])(this,e),a=(0,i["default"])(this,(0,p["default"])(e).call(this,t)),a.getStatus=function(){var t=a.props.dispatch,e=a.state,r=e.roleId,c=e.buyContractBasicId,n=e.userCompanyName;t({type:"contract/getStatus",payload:{buyContractBasicId:c,userCompanyName:n,roleId:Number(r)},callback:function(t,e,r){0===t&&a.setState({status:r.confirmStatus,statusData:r})}})},a.sureContract=function(){var t=a.props.dispatch,e=a.state,r=e.fileName,c=e.uri,n=e.roleId,l=e.buyContractBasicId,o=e.userCompanyName,s=e.type;switch(s){case"0":t({type:"contract/confirmContract",payload:{buyContractBasicId:l,userCompanyName:o,name:r,url:c,roleId:n},callback:function(t,e,r){0===t?(u["default"].success(e),a.getStatus()):u["default"].error(e)}});break;case"1":t({type:"contract/confirmContract",payload:{saleContractBasicId:l,userCompanyName:o,name:r,url:c,roleId:n},callback:function(t,e,r){0===t?(u["default"].success(e),a.getStatus()):u["default"].error(e)}});break;case"2":t({type:"contract/confirmContract",payload:{storageContractBasicId:l,userCompanyName:o,name:r,url:c,roleId:n},callback:function(t,e,r){0===t?(u["default"].success(e),a.getStatus()):u["default"].error(e)}});break;case"4":t({type:"contract/confirmContract",payload:{largeBuyContractBasicId:l,userCompanyName:o,name:r,url:c,roleId:n},callback:function(t,e,r){0===t?(u["default"].success(e),a.getStatus()):u["default"].error(e)}});break;default:break}},a.saveContract=function(){var t=a.state,e=t.fileName,r=t.buyContractBasicId,c=t.uri,n=t.type,l=t.pdfUrl,o=a.props.dispatch;switch(a.setState({isSave:!1}),n){case"0":o({type:"contract/updateContractURL",payload:{buyContractBasicId:r,name:e,url:c,pdf:l},callback:function(t,e,a){0===t?u["default"].success(e):u["default"].error(e)}});break;case"1":o({type:"contract/updateContractURL",payload:{saleContractBasicId:r,name:e,url:c,pdf:l},callback:function(t,e,a){0===t?u["default"].success(e):u["default"].error(e)}});break;case"2":o({type:"contract/updateContractURL",payload:{storageContractBasicId:r,name:e,url:c,pdf:l},callback:function(t,e,a){0===t?u["default"].success(e):u["default"].error(e)}});break;case"4":o({type:"contract/updateContractURL",payload:{largeBuyContractBasicId:r,name:e,url:c,pdf:l},callback:function(t,e,a){0===t?u["default"].success(e):u["default"].error(e)}});break;default:break}},a.uriChange=function(t){"uploading"===t?a.setState({percent:1,uri:"",pdfUrl:""},function(){a.process()}):a.setState({uri:t.value.wordDate.access_url,pdfUrl:t.value.pdfDate.access_url,fileName:t.name,isSave:!0})},a.process=function(){var t=1,e=setInterval(function(){t++,a.setState({percent:t},function(){99===t&&clearInterval(e)})},10)},a.backTo=function(){var t=a.state.buyOrdersId;k["default"].push("/orderManage/details?enterType=1&key=contract&id=".concat(t))},a.state={uri:"",fileName:null,statusData:null,status:0,contractDetail:null,buyOrdersId:null,buyContractBasicId:null,right:!1,userCompanyName:null,type:sessionStorage.businessMode,confirmStatus:a.props.location.query.status,isSave:!1,contractType:null,pdfUrl:"",percent:0},a.timer=null,a}return(0,f["default"])(e,t),(0,d["default"])(e,[{key:"componentDidMount",value:function(){var t=this,e=this.props.dispatch;this.setState({roleId:this.props.global.role.roleId,buyOrdersId:this.props.location.query.orderId,buyContractBasicId:this.props.location.query.contractBasicId,userCompanyName:this.props.global.user.companyName,contractType:this.props.location.query.contractType},function(){t.getStatus();var a=t.state,r=a.buyOrdersId,c=a.buyContractBasicId,n=(a.contractType,a.roleId);e({type:"contract/getContractDetail",payload:{buyOrdersId:r,buyContractBasicId:c},callback:function(e,a,r){0===e?t.setState({contractDetail:r,uri:r.url,pdfUrl:r.pdf,fileName:r.name,percent:100}):u["default"].error(a)}}),t.setState({right:4===n})})}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"render",value:function(){var t=this,e=this.state,a=e.uri,r=e.status,c=e.right,u=e.isSave,s=e.confirmStatus,d=e.pdfUrl,i=e.percent,p=e.buyOrdersId,f=d&&d.match(".pdf");return a&&d&&99===i&&this.setState({percent:100}),g["default"].createElement(g.Fragment,null,g["default"].createElement("div",{className:v["default"].crumb},g["default"].createElement(o["default"],null,g["default"].createElement(o["default"].Item,null,g["default"].createElement(E["default"],{to:"/orderManage/details?enterType=1&key=contract&id=".concat(p)},"\u8ba2\u5355\u8be6\u60c5")),g["default"].createElement(o["default"].Item,null,"\u5408\u540c\u8be6\u60c5"))),g["default"].createElement("div",{className:v["default"].contractWrap},g["default"].createElement("div",{className:v["default"].contractBox},g["default"].createElement("div",{className:v["default"].contractContent,style:f?{top:"0"}:{}},100===i&&(d||a)?f?g["default"].createElement("embed",{src:d,type:"application/pdf",width:"100%",height:"100%"}):g["default"].createElement("iframe",{src:"https://view.officeapps.live.com/op/view.aspx?src=".concat(a),width:"100%",id:"printBox",height:"100%",frameBorder:"1"}):g["default"].createElement(l["default"],{style:{marginTop:"500px"},percent:i,status:"active"}),g["default"].createElement("div",{className:v["default"].coverBar,style:f?{display:"none"}:{}})),c?g["default"].createElement("div",{className:v["default"].contractBtn},0===r?g["default"].createElement(n["default"],{style:{marginRight:"10px"},onClick:this.sureContract,type:"primary",disabled:u||!(3!==s&&4!==s)},g["default"].createElement("span",null,"\u786e\u8ba4\u5408\u540c")):g["default"].createElement(n["default"],{style:{marginRight:"10px"},onClick:this.sureContract,type:"primary",disabled:!0},g["default"].createElement("span",null,"\u5df2\u786e\u8ba4")),g["default"].createElement(h.FileWordUpload,{disabled:9===r,onChange:function(e){return t.uriChange(e)},showUploadList:!1,labelInValue:!0,Button:g["default"].createElement(n["default"],{type:"primary",style:{marginRight:"10px"},disabled:0!==r||!(3!==s&&4!==s)},"\u4e0a\u4f20\u5408\u540c"),type:1}),g["default"].createElement(n["default"],{style:{marginRight:"10px"},onClick:this.backTo},g["default"].createElement("span",null,"\u8fd4\u56de")),a?g["default"].createElement(n["default"],{type:"primary",style:{marginRight:"10px"},onClick:function(){return window.open(a)}},"\u4e0b\u8f7d\u5408\u540c"):null,g["default"].createElement(n["default"],{style:{marginRight:"10px"},onClick:this.saveContract,type:"primary",disabled:0!==r||!(3!==s&&4!==s)||!a||!u},g["default"].createElement("span",null,"\u4fdd\u5b58"))):g["default"].createElement("div",{className:v["default"].contractBtn},g["default"].createElement(n["default"],{style:{marginRight:"10px"},onClick:this.backTo},g["default"].createElement("span",null,"\u8fd4\u56de")),a?g["default"].createElement(n["default"],{type:"primary",style:{marginRight:"10px"},onClick:function(){return window.open(a)}},"\u4e0b\u8f7d\u5408\u540c"):null),g["default"].createElement("div",{className:v["default"].cover,style:f?{display:"none"}:{}}))))}}]),e}(g.Component),y=b))||y)||y),_=N;e["default"]=_},NtgZ:function(t,e,a){t.exports={contractWrap:"contractWrap____fbtJ",contractBox:"contractBox___Bjf9L",contractContent:"contractContent___6pNif",coverBar:"coverBar___ZUjba",contractBtn:"contractBtn___XNxl8",cover:"cover___29FdI",crumb:"crumb___2JPQs"}}}]);